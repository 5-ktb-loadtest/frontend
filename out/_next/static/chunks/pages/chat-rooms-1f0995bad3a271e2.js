(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[301],{48331:(e,r,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/chat-rooms",function(){return t(70836)}])},83867:(e,r,t)=>{"use strict";t.d(r,{Q:()=>i,v:()=>c});var n=t(85893),o=t(67294),a=t(11163),s=t(31530),l=t(19182);let i=e=>{let r=r=>{let t=(0,a.useRouter)(),[s,i]=(0,o.useState)(!0);return((0,o.useEffect)(()=>{l.Z.getCurrentUser()?i(!1):t.replace("/?redirect="+t.asPath)},[t]),s)?null:(0,n.jsx)(e,{...r})},t=e.displayName||e.name||"Component";return r.displayName="WithAuth(".concat(t,")"),r},c=e=>{let r=r=>{let t=(0,a.useRouter)(),[i,c]=(0,o.useState)(!0);return((0,o.useEffect)(()=>{(async()=>{t.isReady&&(l.Z.getCurrentUser()&&"/"===t.pathname?await t.replace("/chat-rooms"):c(!1))})()},[t,t.isReady]),i)?(0,n.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100vh",backgroundColor:"var(--vapor-color-background)",color:"var(--vapor-color-text-primary)"},children:(0,n.jsx)(s.x,{typography:"body1",children:"Loading..."})}):(0,n.jsx)(e,{...r})},t=e.displayName||e.name||"Component";return r.displayName="WithoutAuth(".concat(t,")"),r}},4987:(e,r,t)=>{"use strict";t.d(r,{C:()=>x}),t(20798);var n=t(67294),o=t(36370),a=t(90512),s=t(64584),l=t(85893),i=Object.defineProperty,c=Object.defineProperties,d=Object.getOwnPropertyDescriptors,u=Object.getOwnPropertySymbols,p=Object.prototype.hasOwnProperty,h=Object.prototype.propertyIsEnumerable,f=(e,r,t)=>r in e?i(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,y=(e,r)=>{for(var t in r||(r={}))p.call(r,t)&&f(e,t,r[t]);if(u)for(var t of u(r))h.call(r,t)&&f(e,t,r[t]);return e},m=(e,r)=>c(e,d(r)),g=(e,r)=>{var t={};for(var n in e)p.call(e,n)&&0>r.indexOf(n)&&(t[n]=e[n]);if(null!=e&&u)for(var n of u(e))0>r.indexOf(n)&&h.call(e,n)&&(t[n]=e[n]);return t},v=()=>(e,r)=>r.reduce((e,r)=>{let[t,n]=e;return void 0!==n[r]&&(t[r]=n[r]),delete n[r],[t,n]},[{},y({},e)]),b=(0,s.c)({defaultClassName:"badge__14317c4c badge__14317c40",variantClassNames:{color:{primary:"badge__14317c41",hint:"badge__14317c42",danger:"badge__14317c43",success:"badge__14317c44",warning:"badge__14317c45",contrast:"badge__14317c46"},shape:{square:"badge__14317c47",pill:"badge__14317c48"},size:{sm:"badge__14317c49",md:"badge__14317c4a",lg:"badge__14317c4b"}},defaultVariants:{color:"primary",size:"md",shape:"square"},compoundVariants:[]}),x=(0,n.forwardRef)((e,r)=>{var{className:t,children:n}=e,s=g(e,["className","children"]);let[i,c]=v()(s,["color","size","shape"]);return(0,l.jsx)(o.WV.span,m(y({ref:r,className:(0,a.Z)(b(i),t)},c),{children:n}))});x.displayName="Badge"},2026:(e,r,t)=>{"use strict";t.d(r,{U:()=>x}),t(77507);var n=t(67294),o=t(36370),a=t(90512),s=t(64584),l=t(85893),i=Object.defineProperty,c=Object.defineProperties,d=Object.getOwnPropertyDescriptors,u=Object.getOwnPropertySymbols,p=Object.prototype.hasOwnProperty,h=Object.prototype.propertyIsEnumerable,f=(e,r,t)=>r in e?i(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,y=(e,r)=>{for(var t in r||(r={}))p.call(r,t)&&f(e,t,r[t]);if(u)for(var t of u(r))h.call(r,t)&&f(e,t,r[t]);return e},m=(e,r)=>c(e,d(r)),g=(e,r)=>{var t={};for(var n in e)p.call(e,n)&&0>r.indexOf(n)&&(t[n]=e[n]);if(null!=e&&u)for(var n of u(e))0>r.indexOf(n)&&h.call(e,n)&&(t[n]=e[n]);return t},v=()=>(e,r)=>r.reduce((e,r)=>{let[t,n]=e;return void 0!==n[r]&&(t[r]=n[r]),delete n[r],[t,n]},[{},y({},e)]),b=(0,s.c)({defaultClassName:"callout__17t9x5h7 callout__17t9x5h0",variantClassNames:{color:{primary:"callout__17t9x5h1",success:"callout__17t9x5h2",warning:"callout__17t9x5h3",danger:"callout__17t9x5h4",hint:"callout__17t9x5h5",contrast:"callout__17t9x5h6"}},defaultVariants:{color:"primary"},compoundVariants:[]}),x=(0,n.forwardRef)((e,r)=>{var{className:t,children:n}=e,s=g(e,["className","children"]);let[i,c]=v()(s,["color"]);return(0,l.jsx)(o.WV.div,m(y({ref:r,className:(0,a.Z)(b(i),t)},c),{children:n}))});x.displayName="Callout"},1539:(e,r,t)=>{"use strict";t.d(r,{Zb:()=>j}),t(93406);var n=t(67294),o=t(36370),a=t(90512),s=t(85893),l=Object.defineProperty,i=Object.defineProperties,c=Object.getOwnPropertyDescriptors,d=Object.getOwnPropertySymbols,u=Object.prototype.hasOwnProperty,p=Object.prototype.propertyIsEnumerable,h=(e,r,t)=>r in e?l(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,f=(e,r)=>{for(var t in r||(r={}))u.call(r,t)&&h(e,t,r[t]);if(d)for(var t of d(r))p.call(r,t)&&h(e,t,r[t]);return e},y=(e,r)=>i(e,c(r)),m=(e,r)=>{var t={};for(var n in e)u.call(e,n)&&0>r.indexOf(n)&&(t[n]=e[n]);if(null!=e&&d)for(var n of d(e))0>r.indexOf(n)&&p.call(e,n)&&(t[n]=e[n]);return t},g=(0,n.forwardRef)((e,r)=>{var{className:t,children:n}=e,l=m(e,["className","children"]);return(0,s.jsx)(o.WV.div,y(f({ref:r,className:(0,a.Z)("card__18rs0li0",t)},l),{children:n}))});g.displayName="Card";var v=(0,n.forwardRef)((e,r)=>{var{className:t,children:n}=e,l=m(e,["className","children"]);return(0,s.jsx)(o.WV.div,y(f({ref:r,className:(0,a.Z)("card__18rs0li1",t)},l),{children:n}))});v.displayName="Card.Header";var b=(0,n.forwardRef)((e,r)=>{var{className:t,children:n}=e,l=m(e,["className","children"]);return(0,s.jsx)(o.WV.div,y(f({ref:r,className:(0,a.Z)("card__18rs0li2",t)},l),{children:n}))});b.displayName="Card.Body";var x=(0,n.forwardRef)((e,r)=>{var{className:t,children:n}=e,l=m(e,["className","children"]);return(0,s.jsx)(o.WV.div,y(f({ref:r,className:(0,a.Z)("card__18rs0li3",t)},l),{children:n}))});x.displayName="Card.Footer";var j={Root:g,Header:v,Body:b,Footer:x}},32602:(e,r,t)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e,r){for(var t in r)Object.defineProperty(e,t,{enumerable:!0,get:r[t]})}(r,{default:function(){return l},noSSR:function(){return s}});let n=t(38754);t(85893),t(67294);let o=n._(t(35491));function a(e){return{default:(null==e?void 0:e.default)||e}}function s(e,r){return delete r.webpack,delete r.modules,e(r)}function l(e,r){let t=o.default,n={loading:e=>{let{error:r,isLoading:t,pastDelay:n}=e;return null}};e instanceof Promise?n.loader=()=>e:"function"==typeof e?n.loader=e:"object"==typeof e&&(n={...n,...e});let l=(n={...n,...r}).loader;return(n.loadableGenerated&&(n={...n,...n.loadableGenerated},delete n.loadableGenerated),"boolean"!=typeof n.ssr||n.ssr)?t({...n,loader:()=>null!=l?l().then(a):Promise.resolve(a(()=>null))}):(delete n.webpack,delete n.modules,s(t,n))}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),e.exports=r.default)},1159:(e,r,t)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"LoadableContext",{enumerable:!0,get:function(){return n}});let n=t(38754)._(t(67294)).default.createContext(null)},35491:(e,r,t)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"default",{enumerable:!0,get:function(){return p}});let n=t(38754)._(t(67294)),o=t(1159),a=[],s=[],l=!1;function i(e){let r=e(),t={loading:!0,loaded:null,error:null};return t.promise=r.then(e=>(t.loading=!1,t.loaded=e,e)).catch(e=>{throw t.loading=!1,t.error=e,e}),t}class c{promise(){return this._res.promise}retry(){this._clearTimeouts(),this._res=this._loadFn(this._opts.loader),this._state={pastDelay:!1,timedOut:!1};let{_res:e,_opts:r}=this;e.loading&&("number"==typeof r.delay&&(0===r.delay?this._state.pastDelay=!0:this._delay=setTimeout(()=>{this._update({pastDelay:!0})},r.delay)),"number"==typeof r.timeout&&(this._timeout=setTimeout(()=>{this._update({timedOut:!0})},r.timeout))),this._res.promise.then(()=>{this._update({}),this._clearTimeouts()}).catch(e=>{this._update({}),this._clearTimeouts()}),this._update({})}_update(e){this._state={...this._state,error:this._res.error,loaded:this._res.loaded,loading:this._res.loading,...e},this._callbacks.forEach(e=>e())}_clearTimeouts(){clearTimeout(this._delay),clearTimeout(this._timeout)}getCurrentValue(){return this._state}subscribe(e){return this._callbacks.add(e),()=>{this._callbacks.delete(e)}}constructor(e,r){this._loadFn=e,this._opts=r,this._callbacks=new Set,this._delay=null,this._timeout=null,this.retry()}}function d(e){return function(e,r){let t=Object.assign({loader:null,loading:null,delay:200,timeout:null,webpack:null,modules:null},r),a=null;function i(){if(!a){let r=new c(e,t);a={getCurrentValue:r.getCurrentValue.bind(r),subscribe:r.subscribe.bind(r),retry:r.retry.bind(r),promise:r.promise.bind(r)}}return a.promise()}if(!l){let e=t.webpack?t.webpack():t.modules;e&&s.push(r=>{for(let t of e)if(r.includes(t))return i()})}function d(e,r){!function(){i();let e=n.default.useContext(o.LoadableContext);e&&Array.isArray(t.modules)&&t.modules.forEach(r=>{e(r)})}();let s=n.default.useSyncExternalStore(a.subscribe,a.getCurrentValue,a.getCurrentValue);return n.default.useImperativeHandle(r,()=>({retry:a.retry}),[]),n.default.useMemo(()=>{var r;return s.loading||s.error?n.default.createElement(t.loading,{isLoading:s.loading,pastDelay:s.pastDelay,timedOut:s.timedOut,error:s.error,retry:a.retry}):s.loaded?n.default.createElement((r=s.loaded)&&r.default?r.default:r,e):null},[e,s])}return d.preload=()=>i(),d.displayName="LoadableComponent",n.default.forwardRef(d)}(i,e)}function u(e,r){let t=[];for(;e.length;){let n=e.pop();t.push(n(r))}return Promise.all(t).then(()=>{if(e.length)return u(e,r)})}d.preloadAll=()=>new Promise((e,r)=>{u(a).then(e,r)}),d.preloadReady=e=>(void 0===e&&(e=[]),new Promise(r=>{let t=()=>(l=!0,r());u(s,e).then(t,t)})),window.__NEXT_PRELOADREADY=d.preloadReady;let p=d},70836:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>ea});var n,o=t(85893),a=t(67294),s=t(11163),l=t(5152),i=t.n(l),c=t(18237),d=t(31530),u=t(4987),p=t(74303),h=t(1539),f=t(2026),y=t(22226),m=t(39781);let g=e=>{let{children:r,className:t,...n}=e;return(0,o.jsx)("div",{className:(0,m.cn)("styled-table-wrapper",t),children:(0,o.jsx)("table",{className:"styled-table",...n,children:r})})},v=e=>{let{children:r,className:t,...n}=e;return(0,o.jsx)("thead",{className:(0,m.cn)("styled-table-head",t),...n,children:r})},b=e=>{let{children:r,className:t,...n}=e;return(0,o.jsx)("tbody",{className:(0,m.cn)("styled-table-body",t),...n,children:r})},x=e=>{let{children:r,className:t,onClick:n,...a}=e;return(0,o.jsx)("tr",{className:(0,m.cn)("styled-table-row",n&&"clickable",t),onClick:n,...a,children:r})},j=e=>{let{children:r,className:t,width:n,...a}=e;return(0,o.jsx)("th",{className:(0,m.cn)("styled-table-header",t),style:{width:n,...a.style},...a,children:r})},_=e=>{let{children:r,className:t,...n}=e;return(0,o.jsx)("td",{className:(0,m.cn)("styled-table-cell",t),...n,children:r})};var w=t(37804),C=t(19182),E=t(87066);let N="http://34.64.60.60:5000/";N||console.warn("Warning: NEXT_PUBLIC_API_URL is not defined in environment variables");let O={maxRetries:3,initialDelayMs:1e3,maxDelayMs:5e3,backoffFactor:2,retryableStatuses:[408,429,500,502,503,504],retryableErrors:["ECONNABORTED","ETIMEDOUT","ENOTFOUND","ENETUNREACH","ERR_NETWORK"]},R=E.Z.create({baseURL:N||"http://localhost:5000",timeout:3e4,withCredentials:!0,headers:{Accept:"application/json","Content-Type":"application/json"}}),k=e=>Math.min(O.initialDelayMs*Math.pow(O.backoffFactor,e)*(1+.1*Math.random()),O.maxDelayMs),T=e=>{var r;return!!e&&(!!(e.code&&O.retryableErrors.includes(e.code)||(null===(r=e.response)||void 0===r?void 0:r.status)&&O.retryableStatuses.includes(e.response.status))||!e.response&&!!e.request)},S=new Map;R.interceptors.request.use(async e=>{try{"get"===e.method||e.data||(e.data={});let r=C.Z.getCurrentUser();return(null==r?void 0:r.token)&&(e.headers["x-auth-token"]=r.token,r.sessionId&&(e.headers["x-session-id"]=r.sessionId)),e}catch(e){return console.error("Request interceptor error:",e),Promise.reject(e)}},e=>Promise.reject(e)),R.interceptors.response.use(e=>{let r="".concat(e.config.method,":").concat(e.config.url);return S.delete(r),e},async e=>{let r;let t=e.config||{};if(t.retryCount=t.retryCount||0,E.Z.isCancel(e))return console.log("Request canceled:",e.message),Promise.reject(e);if(T(e)&&t.retryCount<O.maxRetries){t.retryCount++;let e=k(t.retryCount);console.log("Retrying request (".concat(t.retryCount,"/").concat(O.maxRetries,") ")+"after ".concat(Math.round(e),"ms:"),t.url);try{return await new Promise(r=>setTimeout(r,e)),await R(t)}catch(e){return t.retryCount>=O.maxRetries&&console.error("Max retry attempts reached:",t.url),Promise.reject(e)}}if(!e.response){let r=Error();throw r.message=["서버와 통신할 수 없습니다.","네트워크 연결을 확인하고 잠시 후 다시 시도해주세요.",e.code?"(Error: ".concat(e.code,")"):""].filter(Boolean).join(" "),r.isNetworkError=!0,r.originalError=e,r.status=0,r.code=e.code||"NETWORK_ERROR",r.config=t,r.retry=async()=>{try{return await R(t)}catch(e){throw console.error("Manual retry failed:",e),e}},r}let n=e.response.status,o=e.response.data;switch(n){case 400:r=(null==o?void 0:o.message)||"잘못된 요청입니다.";break;case 401:r="인증이 필요하거나 만료되었습니다.";break;case 403:r=(null==o?void 0:o.message)||"접근 권한이 없습니다.";break;case 404:r=(null==o?void 0:o.message)||"요청한 리소스를 찾을 수 없습니다.";break;case 408:r="요청 시간이 초과되었습니다.";break;case 429:r="너무 많은 요청이 발생했습니다. 잠시 후 다시 시도해주세요.";break;case 500:r="서버 오류가 발생했습니다. 잠시 후 다시 시도해주세요.";break;case 502:case 503:case 504:r="서버가 일시적으로 응답할 수 없습니다. 잠시 후 다시 시도해주세요.";break;default:r=(null==o?void 0:o.message)||"예기치 않은 오류가 발생했습니다."}let a=Error(r);if(a.status=n,a.code=null==o?void 0:o.code,a.data=o,a.config=t,a.originalError=e,a.retry=async()=>{try{return await R(t)}catch(e){throw console.error("Manual retry failed:",e),e}},401===n)try{if(await C.Z.refreshToken()){let e=C.Z.getCurrentUser();if(null==e?void 0:e.token)return t.headers["x-auth-token"]=e.token,R(t)}}catch(e){console.error("Token refresh failed:",e),C.Z.logout(),window.location.href="/?error=session_expired"}throw a});var P=t(83867),D=t(78536);let I=e=>{let{isOpen:r=!1,onClose:t,title:n,children:s,size:l="md",className:i="",...u}=e;return((0,a.useEffect)(()=>{let e=e=>{"Escape"===e.key&&r&&(null==t||t())};return r&&(document.addEventListener("keydown",e),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",e),document.body.style.overflow="unset"}},[r,t]),r)?(0,o.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1050,padding:"var(--vapor-space-200)"},onClick:e=>{e.target===e.currentTarget&&(null==t||t())},children:(0,o.jsxs)("div",{style:{backgroundColor:"var(--vapor-color-normal)",borderRadius:"var(--vapor-radius-lg)",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.15)",maxWidth:{sm:"400px",md:"500px",lg:"800px",xl:"1140px"}[l],width:"100%",maxHeight:"90vh",overflow:"auto"},className:i,...u,children:[n&&(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"var(--vapor-space-300) var(--vapor-space-400)",borderBottom:"1px solid var(--vapor-color-secondary)"},children:[(0,o.jsx)(d.x,{typography:"heading5",children:n}),(0,o.jsx)(p.z,{variant:"ghost",size:"sm",onClick:t,style:{padding:"var(--vapor-space-100)",minWidth:"auto"},children:(0,o.jsx)(c.yNA,{size:16})})]}),(0,o.jsx)("div",{style:{padding:"var(--vapor-space-400)"},children:s})]})}):null},M=e=>{let{children:r,className:t="",...n}=e;return(0,o.jsx)("div",{style:{padding:"var(--vapor-space-400)"},className:t,...n,children:r})},z=e=>{let{children:r,className:t="",...n}=e;return(0,o.jsx)("div",{style:{display:"flex",gap:"var(--vapor-space-200)",justifyContent:"flex-end",padding:"var(--vapor-space-300) var(--vapor-space-400)",borderTop:"1px solid var(--vapor-color-secondary)"},className:t,...n,children:r})};var L=t(87462),Z=t(63366);function A(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function U(e,r){return(U=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,r){return e.__proto__=r,e})(e,r)}var V=t(45697),W=t.n(V),F=t(93967),B=t.n(F),q={};function G(e){q[e]||("undefined"!=typeof console&&console.error(e),q[e]=!0)}var H="object"==typeof window&&window.Element||function(){};W().oneOfType([W().string,W().func,function(e,r,t){if(!(e[r]instanceof H))return Error("Invalid prop `"+r+"` supplied to `"+t+"`. Expected prop to be an instance of Element. Validation failed.")},W().shape({current:W().any})]);var K=W().oneOfType([W().func,W().string,W().shape({$$typeof:W().symbol,render:W().func}),W().arrayOf(W().oneOfType([W().func,W().string,W().shape({$$typeof:W().symbol,render:W().func})]))]),X=("undefined"!=typeof window&&window.document&&window.document.createElement,["className","cssModule","type","bsSize","valid","invalid","tag","addon","plaintext","innerRef"]),$={children:W().node,type:W().string,size:W().oneOfType([W().number,W().string]),bsSize:W().string,valid:W().bool,invalid:W().bool,tag:K,innerRef:W().oneOfType([W().object,W().func,W().string]),plaintext:W().bool,addon:W().bool,className:W().string,cssModule:W().object},Y=function(e){function r(r){var t;return(t=e.call(this,r)||this).getRef=t.getRef.bind(A(t)),t.focus=t.focus.bind(A(t)),t}r.prototype=Object.create(e.prototype),r.prototype.constructor=r,U(r,e);var t=r.prototype;return t.getRef=function(e){this.props.innerRef&&this.props.innerRef(e),this.ref=e},t.focus=function(){this.ref&&this.ref.focus()},t.render=function(){var e,r,t=this.props,o=t.className,s=t.cssModule,l=t.type,i=t.bsSize,c=t.valid,d=t.invalid,u=t.tag,p=t.addon,h=t.plaintext,f=t.innerRef,y=(0,Z.Z)(t,X),m=["radio","checkbox"].indexOf(l)>-1,g=RegExp("\\D","g"),v="file"===l,b="textarea"===l,x="select"===l,j="range"===l,_=u||(x||b?l:"input"),w="form-control";h?(w+="-plaintext",_=u||"input"):v?w+="-file":j?w+="-range":m&&(w=p?null:"form-check-input"),y.size&&g.test(y.size)&&(G('Please use the prop "bsSize" instead of the "size" to bootstrap\'s input sizing.'),i=y.size,delete y.size);var C=(void 0===(e=B()(o,d&&"is-invalid",c&&"is-valid",!!i&&"form-control-"+i,w))&&(e=""),void 0===(r=s)&&(r=n),r)?e.split(" ").map(function(e){return r[e]||e}).join(" "):e;return("input"===_||u&&"function"==typeof u)&&(y.type=l),y.children&&!(h||"select"===l||"string"!=typeof _||"select"===_)&&(G('Input with a type of "'+l+'" cannot have children. Please use "value"/"defaultValue" instead.'),delete y.children),a.createElement(_,(0,L.Z)({},y,{ref:f,className:C,"aria-invalid":d}))},r}(a.Component);Y.propTypes=$,Y.defaultProps={type:"text"};let Q={CHECKING:"checking",CONNECTING:"connecting",CONNECTED:"connected",DISCONNECTED:"disconnected",ERROR:"error"},J={[Q.CHECKING]:{label:"연결 확인 중...",color:"warning"},[Q.CONNECTING]:{label:"연결 중...",color:"warning"},[Q.CONNECTED]:{label:"연결됨",color:"success"},[Q.DISCONNECTED]:{label:"연결 끊김",color:"danger"},[Q.ERROR]:{label:"연결 오류",color:"danger"}},ee={maxRetries:3,baseDelay:1e3,maxDelay:5e3,backoffFactor:2},er=e=>{let{text:r}=e;return(0,o.jsxs)("div",{className:"loading-indicator",children:[(0,o.jsx)("div",{className:"spinner-border spinner-border-sm me-3",role:"status",children:(0,o.jsx)("span",{className:"visually-hidden",children:"Loading..."})}),(0,o.jsx)(d.x,{typography:"body3",foreground:"secondary",children:r})]})},et=e=>{let{children:r,onScroll:t,loadingMore:n,hasMore:s,rooms:l}=e,i=(0,a.useRef)(null),c=(0,a.useRef)(null),u=(0,a.useRef)(Date.now()),p=(0,a.useCallback)(e=>{let r=Date.now(),o=e.target;if(r-u.current>=150){let{scrollHeight:e,scrollTop:a,clientHeight:l}=o,i=e-(a+l);if(console.log("Scroll check:",{scrollHeight:e,scrollTop:a,clientHeight:l,distanceToBottom:i,loadingMore:n,hasMore:s,timeSinceLastCheck:r-u.current}),i<50&&!n&&s){console.log("Triggering load more..."),u.current=r,t();return}u.current=r}else c.current||(c.current=setTimeout(()=>{let{scrollHeight:e,scrollTop:r,clientHeight:a}=o,l=e-(r+a);console.log("Debounced scroll check:",{scrollHeight:e,scrollTop:r,clientHeight:a,distanceToBottom:l,loadingMore:n,hasMore:s}),l<50&&!n&&s&&(console.log("Triggering load more (debounced)..."),t()),c.current=null,u.current=Date.now()},150))},[n,s,t]);return(0,a.useEffect)(()=>{let e=i.current;return e&&e.addEventListener("scroll",p,{passive:!0}),()=>{e&&e.removeEventListener("scroll",p),c.current&&(clearTimeout(c.current),c.current=null)}},[p]),(0,o.jsxs)("div",{ref:i,className:"chat-rooms-table",style:{height:"430px",overflowY:"auto",position:"relative",borderRadius:"0.5rem",backgroundColor:"var(--background-normal)",border:"1px solid var(--border-color)",scrollBehavior:"smooth",WebkitOverflowScrolling:"touch"},children:[r,n&&(0,o.jsx)("div",{className:"flex items-center justify-center gap-2 p-4 border-t border-gray-700",children:(0,o.jsx)(er,{text:"추가 채팅방을 불러오는 중..."})}),!s&&(null==l?void 0:l.length)>0&&(0,o.jsx)(y.kC,{justify:"center",align:"center",style:{padding:"var(--vapor-space-300)",borderTop:"1px solid var(--vapor-color-border)",width:"100%"},children:(0,o.jsx)(d.x,{typography:"body2",color:"secondary",style:{textAlign:"center"},children:"모든 채팅방을 불러왔습니다."})})]})};function en(){let e=(0,s.useRouter)(),[r,t]=(0,a.useState)([]),[n,l]=(0,a.useState)(null),[i,m]=(0,a.useState)(!0),[E,N]=(0,a.useState)(!1),[O]=(0,a.useState)(C.Z.getCurrentUser()),[k,T]=(0,a.useState)(Q.CHECKING),[S,P]=(0,a.useState)(0),[L,Z]=(0,a.useState)(!1),[A,U]=(0,a.useState)([{id:"createdAt",desc:!0}]),[V,W]=(0,a.useState)(0),[F]=(0,a.useState)(10),[B,q]=(0,a.useState)(!0),[G,H]=(0,a.useState)(!0),[K,X]=(0,a.useState)(!1),[$,en]=(0,a.useState)(!1),[eo,ea]=(0,a.useState)(null),[es,el]=(0,a.useState)(""),ei=(0,a.useRef)(null);(0,a.useRef)(null);let ec=(0,a.useRef)(null),ed=(0,a.useRef)(!1),eu=(0,a.useRef)([]),ep=(0,a.useRef)(0),eh=(0,a.useCallback)(e=>Math.min(ee.baseDelay*Math.pow(ee.backoffFactor,e)*(1+.1*Math.random()),ee.maxDelay),[]),ef=(0,a.useCallback)(async r=>{try{var t,n,o;if(((null===(t=r.response)||void 0===t?void 0:t.status)===401||(null===(o=r.response)||void 0===o?void 0:null===(n=o.data)||void 0===n?void 0:n.code)==="TOKEN_EXPIRED")&&await C.Z.refreshToken())return!0;return C.Z.logout(),e.replace("/?error=session_expired"),!1}catch(r){return console.error("Auth error handling failed:",r),C.Z.logout(),e.replace("/?error=auth_error"),!1}},[e]),ey=(0,a.useCallback)((e,r)=>{let t="채팅방 목록을 불러오는데 실패했습니다.",n="danger",o=!L;if("SERVER_UNREACHABLE"===e.message&&(t="서버와 연결할 수 없습니다. 잠시 후 자동으로 재시도합니다.",n="warning",o=!0,!r&&S<ee.maxRetries)){let e=eh(S);P(e=>e+1),setTimeout(()=>{Z(!0),eg(r)},e)}r||l({title:"채팅방 목록 로드 실패",message:t,type:n,showRetry:o}),T(Q.ERROR)},[L,S,eh]),em=(0,a.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;try{var r;T(Q.CONNECTING);let e=await R.get("/health",{timeout:5e3,retries:1});if((null==e?void 0:null===(r=e.data)||void 0===r?void 0:r.status)==="ok"&&(null==e?void 0:e.status)===200)return T(Q.CONNECTED),P(0),!0;throw Error("Server not ready")}catch(r){if(console.error("Connection attempt ".concat(e+1," failed:"),r),!r.response&&e<ee.maxRetries){let r=eh(e);return await new Promise(e=>setTimeout(e,r)),em(e+1)}throw T(Q.ERROR),Error("SERVER_UNREACHABLE")}},[eh]),eg=(0,a.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!(null==O?void 0:O.token)||ed.current){console.log("Fetch prevented:",{hasToken:!!(null==O?void 0:O.token),isLoading:ed.current});return}try{var r,n,o;ed.current=!0,console.log("Fetching rooms:",{isLoadingMore:e,pageIndex:V}),e?N(!0):(m(!0),l(null)),await em();let a=await R.get("/api/rooms",{params:{page:e?V:0,pageSize:F,sortField:null===(r=A[0])||void 0===r?void 0:r.id,sortOrder:(null===(n=A[0])||void 0===n?void 0:n.desc)?"desc":"asc"}});if(!(null==a?void 0:null===(o=a.data)||void 0===o?void 0:o.data))throw Error("INVALID_RESPONSE");let{data:s,metadata:i}=a.data;console.log("Fetched rooms:",{count:s.length,hasMore:i.hasMore}),t(r=>{if(e){let e=new Set(r.map(e=>e._id)),t=s.filter(r=>!e.has(r._id));return[...r,...t]}return s}),q(s.length===F&&i.hasMore),G&&H(!1)}catch(r){console.error("Rooms fetch error:",r),ey(r,e)}finally{e||m(!1),N(!1),ed.current=!1}},[O,V,F,A,G,em,ey]),ev=(0,a.useCallback)(async()=>{if(E||!B||ed.current){console.log("Load more prevented:",{loadingMore:E,hasMore:B,isLoading:ed.current});return}try{var e,n,o;console.log("Loading more rooms..."),N(!0),ed.current=!0;let a=Math.floor(r.length/F);console.log("Loading page:",a),W(a);let s=await R.get("/api/rooms",{params:{page:a,pageSize:F,sortField:null===(e=A[0])||void 0===e?void 0:e.id,sortOrder:(null===(n=A[0])||void 0===n?void 0:n.desc)?"desc":"asc"}});if(null===(o=s.data)||void 0===o?void 0:o.success){let{data:e,metadata:r}=s.data;console.log("Loaded new rooms:",{count:e.length,hasMore:r.hasMore}),t(r=>{let t=new Set(r.map(e=>e._id)),n=e.filter(e=>!t.has(e._id));return console.log("Unique new rooms:",n.length),[...r,...n]}),q(e.length===F&&r.hasMore)}}catch(e){console.error("Load more rooms error:",e),ey(e,!0)}finally{N(!1),ed.current=!1,D.F.info("추가 채팅방을 불러왔습니다.")}},[E,B,r.length,F,A,ey]);(0,a.useEffect)(()=>{V>0&&eg(!0)},[V,eg]),(0,a.useEffect)(()=>{if(O)return(async()=>{try{await eg(!1)}catch(e){console.error("Initial fetch failed:",e),setTimeout(()=>{k===Q.CHECKING&&eg(!1)},3e3)}})(),ec.current=setInterval(()=>{k===Q.CHECKING&&em()},5e3),()=>{ec.current&&clearInterval(ec.current)}},[O,k,em,eg]),(0,a.useEffect)(()=>{let e=()=>{console.log("Network is online"),T(Q.CONNECTING),ep.current=0,W(0),eg(!1)},r=()=>{console.log("Network is offline"),T(Q.DISCONNECTED),l({title:"네트워크 연결 끊김",message:"인터넷 연결을 확인해주세요.",type:"danger"})};return window.addEventListener("online",e),window.addEventListener("offline",r),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",r)}},[eg]),(0,a.useEffect)(()=>{if(!(null==O?void 0:O.token))return;let e=!0;return(async()=>{try{let r=await w.Z.connect({auth:{token:O.token,sessionId:O.sessionId}});if(!e||!r)return;ei.current=r,Object.entries({connect:()=>{T(Q.CONNECTED),r.emit("joinRoomList")},disconnect:e=>{T(Q.DISCONNECTED),console.log("Socket disconnected:",e)},error:e=>{console.error("Socket error:",e),T(Q.ERROR)},roomCreated:e=>{t(r=>{let t=[e,...r];return eu.current=t,t})},roomDeleted:e=>{t(r=>{let t=r.filter(r=>r._id!==e);return eu.current=t,t})},roomUpdated:e=>{t(r=>{let t=r.map(r=>r._id===e._id?e:r);return eu.current=t,t})}}).forEach(e=>{let[t,n]=e;r.on(t,n)})}catch(t){var r,n;if(console.error("Socket connection error:",t),!e)return;((null===(r=t.message)||void 0===r?void 0:r.includes("Authentication required"))||(null===(n=t.message)||void 0===n?void 0:n.includes("Invalid session")))&&ef({response:{status:401}}),T(Q.ERROR)}})(),()=>{e=!1,ei.current&&(ei.current.disconnect(),ei.current=null)}},[O,ef]);let eb=(e,r)=>{r?(ea(e),en(!0)):ex(e)},ex=async function(r){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(k!==Q.CONNECTED){l({title:"채팅방 입장 실패",message:"서버와 연결이 끊어져 있습니다.",type:"danger"});return}X(!0);try{(await R.post("/api/rooms/".concat(r,"/join"),{password:t},{timeout:5e3})).data.success&&e.push("/chat?room=".concat(r))}catch(r){let e="입장에 실패했습니다.";404===r.status?e="채팅방을 찾을 수 없습니다.":403===r.status&&(e="비밀번호가 틀렸습니다."),en(!1),D.F.error(e)}finally{X(!1)}},ej=()=>{en(!1),ea(null)};return(0,o.jsxs)("div",{className:"auth-container",children:[(0,o.jsx)(D.Z,{}),(0,o.jsxs)(I,{isOpen:$,onClose:()=>ej(),size:"md",title:"비밀번호를 입력해주세요.",children:[(0,o.jsx)(M,{children:(0,o.jsx)(Y,{value:es,onChange:e=>el(e.target.value),type:"password",style:{color:"black"}})}),(0,o.jsxs)(z,{children:[(0,o.jsx)(p.z,{variant:"ghost",onClick:()=>ej(),children:"닫기"}),(0,o.jsx)(p.z,{variant:"ghost",onClick:()=>ex(eo,es),children:"확인"})]})]}),(0,o.jsx)(h.Zb.Root,{className:"chat-rooms-card",children:(0,o.jsxs)(h.Zb.Body,{className:"card-body",children:[(0,o.jsxs)(y.Kq,{gap:"300",align:"center",children:[(0,o.jsx)(d.x,{typography:"heading3",children:"채팅방 목록"}),(0,o.jsxs)(y.Ug,{gap:"200",children:[(0,o.jsx)(u.C,{color:"success"===J[k].color?"success":"warning"===J[k].color?"warning":"danger",children:J[k].label}),(n||k===Q.ERROR)&&(0,o.jsxs)(p.z,{variant:"outline",color:"secondary",size:"sm",onClick:()=>{ep.current=0,W(0),eg(!1)},disabled:L,children:[(0,o.jsx)(c.MnU,{size:16}),"재연결"]})]})]}),n&&(0,o.jsx)(y.xu,{mt:"400",children:(0,o.jsx)(f.U,{color:"danger"===n.type?"danger":"warning"===n.type?"warning":"primary",className:"mb-4",children:(0,o.jsxs)(y.kC,{align:"flex-start",gap:"200",children:[k===Q.ERROR?(0,o.jsx)(c.dFN,{size:16,style:{marginTop:"4px"}}):(0,o.jsx)(c.oC6,{size:16,style:{marginTop:"4px"}}),(0,o.jsxs)("div",{children:[(0,o.jsxs)(d.x,{typography:"heading6",style:{fontWeight:500,paddingRight:10},children:[n.title," "]}),(0,o.jsx)(d.x,{typography:"body2",style:{marginTop:"var(--vapor-space-050)"},children:n.message}),n.showRetry&&!L&&(0,o.jsx)(p.z,{variant:"outline",color:"secondary",size:"sm",style:{marginTop:"var(--vapor-space-200)"},onClick:()=>{ep.current=0,W(0),eg(!1)},children:"다시 시도"})]})]})})}),i?(0,o.jsx)(y.xu,{mt:"400",children:(0,o.jsx)(er,{text:"채팅방 목록을 불러오는 중..."})}):r.length>0?(0,o.jsx)(y.xu,{mt:"400",children:(0,o.jsx)(et,{onScroll:ev,loadingMore:E,hasMore:B,rooms:r,children:r&&0!==r.length?(0,o.jsxs)(g,{children:[(0,o.jsx)(v,{children:(0,o.jsxs)(x,{children:[(0,o.jsx)(j,{width:"45%",children:"채팅방"}),(0,o.jsx)(j,{width:"15%",children:"참여자"}),(0,o.jsx)(j,{width:"25%",children:"생성일"}),(0,o.jsx)(j,{width:"15%",children:"액션"})]})}),(0,o.jsx)(b,{children:r.map(e=>{var r;return(0,o.jsxs)(x,{children:[(0,o.jsxs)(_,{children:[(0,o.jsx)(d.x,{typography:"body1",style:{fontWeight:500,marginBottom:"var(--vapor-space-050)"},children:e.name}),e.hasPassword&&(0,o.jsxs)(y.Ug,{gap:"050",align:"center",children:[(0,o.jsx)(c.mBM,{size:16,style:{color:"var(--vapor-color-warning)"}}),(0,o.jsx)(d.x,{typography:"body1",style:{color:"var(--vapor-color-warning)"},children:"비밀번호 필요"})]})]}),(0,o.jsx)(_,{children:(0,o.jsxs)(u.C,{color:"primary",style:{display:"inline-flex",alignItems:"center",gap:"var(--vapor-space-100)"},children:[(0,o.jsx)(c.BFJ,{size:16}),(0,o.jsx)(d.x,{typography:"body1",style:{color:"inherit"},children:(null===(r=e.participants)||void 0===r?void 0:r.length)||0})]})}),(0,o.jsx)(_,{children:(0,o.jsx)(d.x,{typography:"body1",style:{color:"var(--vapor-color-text-muted)"},children:new Date(e.createdAt).toLocaleString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})})}),(0,o.jsx)(_,{children:(0,o.jsx)(p.z,{color:"primary",variant:"outline",size:"md",onClick:()=>eb(e._id,e.hasPassword),disabled:k!==Q.CONNECTED,children:"입장"})})]},e._id)})})]}):null})}):!n&&(0,o.jsxs)(y.xu,{mt:"400",style:{textAlign:"center"},children:[(0,o.jsx)(d.x,{typography:"body1",style:{marginBottom:"var(--vapor-space-400)"},children:"생성된 채팅방이 없습니다."}),(0,o.jsx)(p.z,{color:"primary",onClick:()=>e.push("/chat-rooms/new"),disabled:k!==Q.CONNECTED,children:"새 채팅방 만들기"})]})]})}),K&&(0,o.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:(0,o.jsxs)(y.Kq,{align:"center",gap:"300",children:[(0,o.jsx)("div",{className:"spinner-border spinner-border-lg text-primary",role:"status",children:(0,o.jsx)("span",{className:"visually-hidden",children:"Loading..."})}),(0,o.jsx)(d.x,{typography:"body1",style:{color:"white"},children:"채팅방 입장 중..."})]})})]})}let eo=i()(()=>Promise.resolve(en),{ssr:!1,loading:()=>(0,o.jsx)("div",{className:"auth-container",children:(0,o.jsx)(h.Zb.Root,{className:"chat-rooms-card",children:(0,o.jsxs)(h.Zb.Body,{className:"card-body",children:[(0,o.jsx)(y.Kq,{gap:"300",align:"center",children:(0,o.jsx)(d.x,{typography:"heading3",children:"채팅방 목록"})}),(0,o.jsx)(y.xu,{mt:"400",children:(0,o.jsx)(er,{text:"로딩 중..."})})]})})})}),ea=(0,P.Q)(eo)},20798:()=>{},77507:()=>{},93406:()=>{},82613:()=>{},5152:(e,r,t)=>{e.exports=t(32602)},92703:(e,r,t)=>{"use strict";var n=t(50414);function o(){}function a(){}a.resetWarningCache=o,e.exports=function(){function e(e,r,t,o,a,s){if(s!==n){var l=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw l.name="Invariant Violation",l}}function r(){return e}e.isRequired=e;var t={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:r,element:e,elementType:e,instanceOf:r,node:e,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:a,resetWarningCache:o};return t.PropTypes=t,t}},45697:(e,r,t)=>{e.exports=t(92703)()},50414:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},93967:(e,r)=>{var t;!function(){"use strict";var n={}.hasOwnProperty;function o(){for(var e="",r=0;r<arguments.length;r++){var t=arguments[r];t&&(e=a(e,function(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return o.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var r="";for(var t in e)n.call(e,t)&&e[t]&&(r=a(r,t));return r}(t)))}return e}function a(e,r){return r?e?e+" "+r:e+r:e}e.exports?(o.default=o,e.exports=o):void 0!==(t=(function(){return o}).apply(r,[]))&&(e.exports=t)}()},87462:(e,r,t)=>{"use strict";function n(){return(n=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(null,arguments)}t.d(r,{Z:()=>n})},63366:(e,r,t)=>{"use strict";function n(e,r){if(null==e)return{};var t={};for(var n in e)if(({}).hasOwnProperty.call(e,n)){if(r.includes(n))continue;t[n]=e[n]}return t}t.d(r,{Z:()=>n})}},e=>{var r=r=>e(e.s=r);e.O(0,[834,888,774,179],()=>r(48331)),_N_E=e.O()}]);